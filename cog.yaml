build:
  gpu: true
  python_version: "3.8"
  system_packages:
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
    - "libsndfile1-dev"
    - "ffmpeg"
  python_packages:
    - "ipython==7.30.1"
    - "numpy==1.21.4"
  run:
    - pip install -U pip
    - pip install --upgrade cython

    - apt-get update && apt-get install libtinfo5
    - wget http://launchpadlibrarian.net/354245868/libreadline7_7.0-3_amd64.deb
    - dpkg -i libreadline7_7.0-3_amd64.deb
    - wget http://security.ubuntu.com/ubuntu/pool/universe/f/fluidsynth/libfluidsynth1_1.1.9-1_amd64.deb
    - dpkg -i libfluidsynth1_1.1.9-1_amd64.deb
    - wget http://launchpadlibrarian.net/353134622/fluidsynth_1.1.9-1_amd64.deb
    - dpkg -i fluidsynth_1.1.9-1_amd64.deb
    - pip install pyfluidsynth

    - pip install git+https://github.com/e7mac/omnizart.git
    - omnizart download-checkpoints --output-path /src

predict: "scripts/predict.py:Predictor"
